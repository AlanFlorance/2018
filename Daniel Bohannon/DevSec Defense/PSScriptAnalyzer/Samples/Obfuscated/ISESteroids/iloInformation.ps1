${______/==\_/=\/=\}=get-content C:\temp\serverlist.txt
${/=\_/\/\/=\____/=}=New-Object -ComObject "Excel.Application"
${/=\/\/\/\_/\/\/=\}=${/=\_/\/\/=\____/=}.workbooks.add()
${/==\___/======\/=}=${/=\/\/\/\_/\/\/=\}.activesheet
${/==\/\___/\/\_/\/}=${/==\___/======\/=}.cells
${/=\_/\/\/=\____/=}.visible=$True
${/==\_/===\____/=\}=1
${_/===\_/=\/\/==\/}=1
"Server name", "Description", "Active ILO license", "IP", "Subnetmask", "ILO name", "Gateway IP", "License key", "URL" | foreach {
	${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/})=$_
	${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/}).font.bold=$True
	${_/===\_/=\/\/==\/}++
	}
foreach (${_/=\/\/\/==\/\_/=} in ${______/==\_/=\/=\}) {
	if(Test-Connection -Cn ${_/=\/\/\/==\/\_/=} -BufferSize 16 -Count 1 -ea 0) {
		${_/\/\/===\/\/====}=get-wmiobject -class hp_managementprocessor -computername ${_/=\/\/\/==\/\_/=} -namespace root\HPQ
		if (${_/\/\/===\/\/====} -eq $Null) {
			${/==\_/===\____/=\}++
			${_/===\_/=\/\/==\/}=1
			${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/})=${_/=\/\/\/==\/\_/=}
			${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/}).interior.colorindex = 6
			${_/===\_/=\/\/==\/}++
			${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/})="No ILO, most likely a virtual machine"
			${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/}).interior.colorindex = 6
			continue
			}
		${/==\_/===\____/=\}++
		${_/===\_/=\/\/==\/}=1
		${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/})=${_/=\/\/\/==\/\_/=}
		${_/===\_/=\/\/==\/}++
		${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/})=${_/\/\/===\/\/====}.Description
		${_/===\_/=\/\/==\/}++
		switch (${_/\/\/===\/\/====}.ActiveLicense) {
			1 {${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/})=${_/\/\/===\/\/====}.ActiveLicense
			${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/}).interior.colorindex = 3
			${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},1).interior.colorindex = 3
			${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},2).interior.colorindex = 3
			}
			2 {${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/})=${_/\/\/===\/\/====}.ActiveLicense
			${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/}).interior.colorindex = 4
			${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},1).interior.colorindex = 4
			${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},2).interior.colorindex = 4
			}
			3 {${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/})=${_/\/\/===\/\/====}.ActiveLicense 
			${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/}).interior.colorindex = 4
			${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},1).interior.colorindex = 4
			${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},2).interior.colorindex = 4
			}
			4 {${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/})=${_/\/\/===\/\/====}.ActiveLicense 
			${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/}).interior.colorindex = 4
			${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},1).interior.colorindex = 4
			${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},2).interior.colorindex = 4
			}
			5 {${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/})=${_/\/\/===\/\/====}.ActiveLicense 
			${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/}).interior.colorindex = 4
			${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},1).interior.colorindex = 4
			${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},2).interior.colorindex = 4
			}
			default {${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/})=${_/\/\/===\/\/====}.ActiveLicense
			${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/}).interior.colorindex = 6
			}
		}
		${_/===\_/=\/\/==\/}++
		${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/})=${_/\/\/===\/\/====}.ipaddress
		${_/===\_/=\/\/==\/}++
		${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/})=${_/\/\/===\/\/====}.ipv4subnetmask
		${_/===\_/=\/\/==\/}++
		${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/})=${_/\/\/===\/\/====}.hostname
		${_/===\_/=\/\/==\/}++
		${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/})=${_/\/\/===\/\/====}.GatewayIPAddress
		${_/===\_/=\/\/==\/}++
		${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/})=${_/\/\/===\/\/====}.LicenseKey
		${_/===\_/=\/\/==\/}++
		${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/})=${_/\/\/===\/\/====}.URL
		} Else {
			${/==\_/===\____/=\}++
			${_/===\_/=\/\/==\/}=1
			${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/})=${_/=\/\/\/==\/\_/=}
			${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/}).interior.colorindex = 3
			${_/===\_/=\/\/==\/}++
			${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/})="Offline"
			${/==\/\___/\/\_/\/}.item(${/==\_/===\____/=\},${_/===\_/=\/\/==\/}).interior.colorindex = 3
			}
}
